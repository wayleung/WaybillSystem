<!DOCTYPE HTML>

<html>
<head>
<title>W速运-首页&mdash;基于物流，融通金融，流通商业</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="W速运管理系统">
<meta name="author" content="Way Leung">
<meta name="keyword" content="WayLeung,System,Waybill,Management,Manage">



<!-- Animate.css -->
<link rel="stylesheet" href="css/animate.css">
<!-- Icomoon Icon Fonts-->
<link rel="stylesheet" href="css/icomoon.css">
<!-- Themify Icons-->
<link rel="stylesheet" href="css/themify-icons.css">
<!-- Bootstrap  -->
<link rel="stylesheet" href="css/bootstrap.css">

<!-- Magnific Popup -->
<link rel="stylesheet" href="css/magnific-popup.css">

<!-- Owl Carousel  -->
<link rel="stylesheet" href="css/owl.carousel.min.css">
<link rel="stylesheet" href="css/owl.theme.default.min.css">

<!-- Theme style  -->
<link rel="stylesheet" href="css/style.css">

<!-- Modernizr JS -->
<script src="js/modernizr-2.6.2.min.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

</head>
<body>

	<div class="gtco-loader"></div>

	<div id="page">

		<nav class="gtco-nav" role="navigation">
			<div class="gtco-container">
				<!-- 			<div class="row">
				<div class="col-md-12 text-right gtco-contact">
					<ul class="">
						<li><a href="#"><i class="ti-mobile"></i> +1 (0)123 456 7890 </a></li>
						<li><a href="http://twitter.com/gettemplatesco"><i class="ti-twitter-alt"></i> </a></li>
						<li><a href="#"><i class="icon-mail2"></i></a></li>
						<li><a href="#"><i class="ti-facebook"></i></a></li>
					</ul>
				</div>
			</div> -->
				<div class="row">
				<div class="col-sm-4 col-xs-12">
					<div id="gtco-logo"><a href="index.html">W速运 <em>.</em></a></div>
				</div>
				
				<div class="col-xs-8 text-right menu-1">
					<ul>
						<li ><a href="index.html">首页</a></li>
						<li   class="active"><a href="search.html">运单查询</a></li>
						<li><a href="fee.html">运费与服务</a></li>
						<li><a href="about.html">公司简介</a></li>
						<li><a href="contactus.html">联系我们</a></li>
						<li class="has-dropdown">
							<a href="#">账户</a>
							<ul id="loginbutton" class="dropdown">				
			
							</ul>
						</li>
					</ul>
					
				</div>
			</div>

			</div>
		</nav>




		<header id="gtco-header" class="gtco-cover gtco-cover-xs"
			role="banner">
			<div class="overlay"></div>
			<div class="gtco-container">
				<div class="row">
					<div class="col-md-8 col-md-offset-2 text-center">
						<div class="display-t">
							<div class="display-tc">
								<h1 class="animate-box" data-animate-effect="fadeInUp">W速运</h1>
								<h2 class="animate-box" data-animate-effect="fadeInUp">基于物流，融通金融，流通商业</h2>
							</div>
						</div>
					</div>
				</div>
			</div>
		</header>









		<div id="gtco-subscribe">
			<div id="waybillStatus">
				<div class="row animate-box">
					<div class="col-md-8 col-md-offset-2 text-center gtco-heading">
						<h2>运单查询</h2>
						<p>W速运竭诚为您服务.</p>
					</div>
				</div>
				<div class="row animate-box">
					<div class="col-md-12">
						<form class="form-inline" action="" method="post">
							<div class="col-md-6 col-sm-6">
								<div class="form-group">
									<label for="name" class="sr-only">运单号</label> <input
										type="text" class="form-control" id="waybill_number"
										name="waybill_number" placeholder="运单号">
								</div>
							</div>
							<div class="col-md-6 col-sm-6">
								<!-- 用ajax的话 button不能是submit 否则会刷新页面 -->
								<button type="button"  v-on:click="showData()" id="search"
									class="btn btn-default btn-block">查询</button>
								<div id="followbutton"></div>
								<p id="msg" style="color: red;text-align: center;"></p>
								
							</div>
						</form>
						
					</div>
				</div>

				<div class="row animate-box">
					<div class="col-md-9 col-sm-9">
						<!-- <table id="waybillStatus" style="display: block; margin-left: 10%;" id="table"> -->
						<table  style="display: block; margin-left: 10%;" id="table">
							<!-- <%-- <c:forEach var="waybillstatus" items="${waybillstatusrtn}"> --%>
								<%-- <tr style="display:block;margin-top: 20px;margin-left: 10px;">
									<td><font color="white">货物在${waybillstatus.locationName}${waybillstatus.statusName}</font></td><td>&nbsp;&nbsp;&nbsp;</td><td><font color="white">${waybillstatus.lacationTime}</font></td><td>&nbsp;&nbsp;&nbsp;</td><td><font color="white">经手人：${waybillstatus.eName}</font></td>
								</tr> --%>
							<%-- </c:forEach> --%> -->


			
									<template  v-for="item in datas">

			  <tr>
			  							
				  			
							<td style="display:block;margin-top: 20px;margin-left: 10px;"><font color="white">{{ item.lacationTime }}：快件{{ item.statusName}}，已到达{{ item.locationName }}，负责人{{ item.name}}</font></td>
				</tr>

							</template>

						</table>
					</div>
				</div>
			</div>
		</div>

		<footer id="gtco-footer" role="contentinfo">
			<div class="gtco-container">
				<div class="row row-p	b-md">

					<div class="col-md-4">
						<div class="gtco-widget">
							<h3>关于我们</h3>
							<p>多年来，W速运持续创新，不断铸造高品质服务体验，为客户成功提供坚实有力的支持</p>
						</div>
					</div>

					<div class="col-md-4 col-md-push-1">
						<div class="gtco-widget">
							<h3>友情连接</h3>
							<ul class="gtco-footer-links">
								<li><a href="#">顺丰速运</a></li>
								<li><a href="#">申通快递</a></li>
								<li><a href="#">中通快递</a></li>
								<li><a href="#">天天快递</a></li>
								<li><a href="#">德邦物流</a></li>
							</ul>
						</div>
					</div>

					<div class="col-md-4">
						<div class="gtco-widget">
							<h3>联系我们</h3>
							<ul class="gtco-quick-contact">
								<li><a href="#"><i class="icon-phone"></i>+86&nbsp;15521608979</a></li>
								<li><a href="#"><i class="icon-mail2"></i>
										wayleung13@163.com</a></li>
								<!-- 							<li><a href="#"><i class="icon-chat"></i> Live Chat</a></li> -->
							</ul>
						</div>
					</div>

				</div>

				<div class="row copyright">
					<div class="col-md-12">
						<p class="pull-left">
							<small class="block">&copy; 2016 Free HTML5. All Rights
								Reserved.</small> <small class="block">更多内容请联系 <a href="#"
								target="_blank" title="Way Leung">Way Leung</a> - Collect from <a
								href="#" title="Way Leung" target="_blank">Way Leung</a>
							</small>
						</p>
						<!-- 					<p class="pull-right">
						<ul class="gtco-social-icons pull-right">
							<li><a href="#"><i class="icon-twitter"></i></a></li>
							<li><a href="#"><i class="icon-facebook"></i></a></li>
							<li><a href="#"><i class="icon-linkedin"></i></a></li>
							<li><a href="#"><i class="icon-dribbble"></i></a></li>
						</ul>
					</p> -->
					</div>
				</div>

			</div>
		</footer>




	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>


</body>


<!-- jQuery -->
<script src="js/jquery.min.js"></script>
<script src="js/vue.min.js"></script>
<script>

function deleteAll(id){
	$('#'+id).empty();
}

function addMsg(id,msg){
	$('#'+id).text(msg);
}
	function getHostPath() {
		var curWwwPath = window.document.location.href;
		var pathName = window.document.location.pathname;
		var pos = curWwwPath.indexOf(pathName);
		//获取主机地址，如： http://localhost:8083
		var localhostPath = curWwwPath.substring(0, pos);
		return localhostPath;
	}

	var rootPath = getHostPath() + "/";


	

	
	
    
    
	$(document).ready(function(){
		$.ajax({
			url : rootPath+'checkWechatAndLogin',
			type : "get",
			async : false,
			success : function(data) {
					console.log(data);
					
					
					/*
					datas
					:
					isLogin
					:
					true
					isWechatBind
					:
					true
					isWechatLogin
					:
					false
					*/
					
				if(data.datas.isLogin==false){
					var ul = "<li><a href=\"login.html\">登录</a></li>";
					$('#loginbutton').append(ul);
				}else{
					var ul = "<li><a href=\"/userLogout\">登出</a></li>";

					
					if(data.datas.isWechatLogin==true&&data.datas.isWechatBind==true){
					//ul+= "<li><a href=\"/wechatUnbind\">解绑微信</a></li>";
					 ul+= "<li><a onclick=\"wechatUnbind()\">解绑微信</a></li>";
					 var btn = "<button type=\"button\" onclick=\"followWaybill()\" class=\"btn btn-default btn-block\">跟踪运单</button>";
					 $('#followbutton').append(btn);
					
					}else if(data.datas.isWechatLogin==true&&data.datas.isWechatBind==false){
						
						 ul+= "<li><a onclick=\"wechatBind()\">绑定微信</a></li>";
						//ul+= "<li><a href=\"/wechatBind\">绑定微信</a></li>";
					}
					
					
					$('#loginbutton').append(ul);
				};
				
			}
		}); 
	});
	
	
	
	function wechatUnbind(){
		$.ajax({
			url:rootPath+"wechatUnbind",
			type:"post",
			async : true,
			success: function(data){
				alert('成功解绑微信');
			}
		});
	}
	
	
	function wechatBind(){
		$.ajax({
			url:rootPath+"wechatBind",
			type:"post",
			async : true,
			success: function(data){
				alert('成功绑定微信');
			}
		});
	}
	
	/*
	 * 查询方法
	 */
	 
	 var status_vm = new Vue({
		 el:"#waybillStatus",
		 data:{
			 datas:{}
		 },
/* 		mounted:function(){
		    this.showData();
		}, */
        methods:{
            showData:function () {
            	var waybillNumber = $("#waybill_number").val();
            	if(waybillNumber==null||waybillNumber==''){
            		deleteAll('msg');
            		status_vm.datas=null;
            		addMsg('msg','运单号不能为空');
            	}else{
            		deleteAll('msg');
            		 $.ajax({
                         type:"GET",
                         url: rootPath+"selectWaybillStatusByWaybillNumber",
                         dataType:"json",
                         //这里的data是输入框的data
                         data: {waybillNumber:waybillNumber},
                         //这里的data是ajax返回的data
                         success:function(data){
                       	  if(data.datas.length<=0){
                       		deleteAll('msg');
                       		status_vm.datas=null;
                    		addMsg('msg','运单号不存在或运单没有状态');
                       	  }else{
                       		status_vm.datas=data.datas;
                       	  }
                       	  
                         },
                         error:function(e){
                         alert("error");
                         }
                       });
            	}
               
              }
            }
	 });
	 
/* 	$("#search").click(	 			 
		function(){
			var waybillNumber = $("#waybill_number").val();
      	  console.log(waybillNumber); 
    		$.ajax({
  			url : rootPath + "selectWaybillStatusByWaybillNumber",
  			type : "get",
  			async : true,
  			dataType : "json",
  			data: {waybillNumber:waybillNumber},
  			//异步   注意数据的获取
  			success : function(datas) {
  				console.log(datas); 
  				   new Vue({
  					  el: '#waybillStatus',
  					  data: datas,
  					}); 
  			}
  	 	});
        }
	); */

	/*
	 * 追踪订单
	 */
	function followWaybill(){
		var waybillNumber = $("#waybill_number").val();
		$.ajax({
			url:rootPath+'followWaybill',
			type:"post",
			async:"true",
			data : {'waybillNumber': waybillNumber},
			dataType:"json",
			success : function(data){
				deleteAll('msg');
        		addMsg('msg',data.msg);
			},
		});
	}
	


</script>
<!-- jQuery Easing -->
<script src="js/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="js/jquery.waypoints.min.js"></script>
<!-- Carousel -->
<script src="js/owl.carousel.min.js"></script>
<!-- countTo -->
<script src="js/jquery.countTo.js"></script>
<!-- Magnific Popup -->
<script src="js/jquery.magnific-popup.min.js"></script>
<script src="js/magnific-popup-options.js"></script>
<!-- Main -->
<script src="js/main.js"></script>






</html>

